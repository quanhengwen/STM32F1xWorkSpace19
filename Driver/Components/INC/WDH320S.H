#ifndef WDH320S_H
#define WDH320S_H

#define BUF_SMALL               -1  //ÊäÈë»º³åÇøÌ«Ğ¡
#define PACK_ISBAD              -2  //Êı¾İ°üÊı¾İÒÑËğ»µ
#define CMD_PACK_SIZE           8   //å‘½ä»¤åŒ…å¤§å°?
#define DATA_PACK_HEAD_SIZE     3   //æ•°æ®åŒ…å¤´éƒ¨å¤§å°?
#define DATA_PACK_TAIL_SIZE     2   //æ•°æ®åŒ…å°¾éƒ¨å¤§å°?


//#include <QDebug>

//inline void dbgTxtPrint(const char *txt)
//{
//#if defined(_MSC_VER)
//    OutputDebugStringA(txt);
//#elif defined(QT_VERSION)
//    qDebug() << txt;
//#else
//    fprintf(stderr, "%s\r\n", txt);
//#ifdef ANDROID_DEBUG
//    #define  LOG_TAG    "WEDONE_NDK_BIOVEIN"
//    #define  LOGD(...)  __android_log_print(ANDROID_LOG_DEBUG, LOG_TAG, __VA_ARGS__)
//    LOGD("%s\n", txt);
//#endif
//#endif
//    return;
//}
//#define dbgInfoPrint(format, ...) {\
//        char LOG__LINE__[10240] = {0}; \
//        snprintf(LOG__LINE__, 10240, "[%s:%04d]: " format,  __FUNCTION__ , __LINE__, ##__VA_ARGS__);\
//        dbgTxtPrint(LOG__LINE__);}



//è®¡ç®—æ ¡éªŒå’?
unsigned char api_wdh320s_get_check_xor(unsigned char *data,unsigned int len);

//å¾—åˆ°å‘é€åŒ…é•¿åº¦
int api_wdh320s_get_pack_len(int cmd, unsigned int Extra_DataLen);

//å¾—åˆ°æ¥æ”¶åŒ…ä¸­ä¸»è¦æ•°æ®é•¿åº¦
#define GetExtraDataLen(packlen) (packlen <= CMD_PACK_SIZE) ? 0 : \
        packlen - CMD_PACK_SIZE - DATA_PACK_HEAD_SIZE - DATA_PACK_TAIL_SIZE;

//è®¾ç½®å‘é€åŒ…
//1.æ–¹æ³•ä¸€(åªé€‚ç”¨äºæ— é™„åŠ æ•°æ®çš„å‘é€åŒ…ï¼?
/**
 * @brief GetSendPack   ã€è®¾ç½®ä¸€ä¸ªæ— é™„åŠ æ•°æ®çš„å‘é€åŒ…ã€?
 * @param p(O)             å‘é€åŒ…ç¼“å†²åŒ?
 * @param _cmd(I)          åŒ…å‘½ä»?
 * @param _device(I)       è®¾å¤‡ID
 * @param _p1(I)           å‚æ•°1 ç”±å…·ä½“å‘½ä»¤å†³å®?
 * @param _p2(I)           å‚æ•°2 ç”±å…·ä½“å‘½ä»¤å†³å®?
 * @param _p3(I)           å‚æ•°3 ç”±å…·ä½“å‘½ä»¤å†³å®?
 */
#define GetSendPack(_pack, _cmd, _device, _p1, _p2, _p3) \
    _pack[0] = ASCII_XON; \
    _pack[1] = _cmd; \
    _pack[2] = _device; \
    _pack[3] = _p1; \
    _pack[4] = _p2; \
    _pack[5] = _p3; \
    _pack[6] = api_wdh320s_get_check_xor(&_pack[0], 6); \
    _pack[7] = ASCII_XOFF


//2.æ–¹æ³•äº?é€‚ç”¨äºæ‰€æœ‰å‘é€åŒ…ï¼?
int api_wdh320s_get_send_pack(unsigned char * p, unsigned char _cmd, unsigned char _device,
                    unsigned char _p1, unsigned char _p2, unsigned char _p3,
                    unsigned char *Extra_Data, unsigned int  Extra_DataLen);


//è·å¾—æ¥æ”¶åŒ…ä¸­çš„ä¸»è¦æ•°æ?
int api_wdh320s_get_pack_data(void *pack, void *ebuf, unsigned int *ebuflen, int *special);


#endif // PACK_H

